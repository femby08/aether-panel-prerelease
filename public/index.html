<!DOCTYPE html>
<html lang="es" data-theme="dark" data-design="glass">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aether Panel</title>
    <!-- Fuentes e Iconos -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Librerías -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css" />
    <link rel="stylesheet" href="style.css">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>

    <div class="background-layer">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
    </div>

    <!-- MODAL PERSONALIZACIÓN -->
    <div id="appearance-modal" class="modal-overlay">
        <div class="modal-card">
            <div class="modal-header">
                <h3>Personalización</h3>
                <button class="btn btn-icon-sm" onclick="closeAllModals()"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="modal-body settings-layout">
                <div class="settings-card">
                    <div class="card-subtitle">Apariencia</div>
                    <div class="setting-row">
                        <span>Tema</span>
                        <div class="segment-box">
                            <button id="theme-btn-light" onclick="setTheme('light')" class="seg-btn"><i class="fa-solid fa-sun"></i></button>
                            <button id="theme-btn-dark" onclick="setTheme('dark')" class="seg-btn active"><i class="fa-solid fa-moon"></i></button>
                        </div>
                    </div>
                    <div class="setting-row">
                        <span>Diseño</span>
                        <div class="segment-box">
                            <button onclick="setDesign('glass')" id="modal-btn-glass" class="seg-btn active">Glass</button>
                            <button onclick="setDesign('material')" id="modal-btn-material" class="seg-btn">Flat</button>
                        </div>
                    </div>
                    <div class="setting-row">
                        <span>Color Acento</span>
                        <input type="color" onchange="setAccentColor(this.value)" value="#8b5cf6">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="app-layout">
        <!-- SIDEBAR -->
        <aside class="sidebar glass-panel">
            <div class="brand-area">
                <div class="logo-box"><i class="fa-solid fa-bolt"></i></div>
                <div class="logo-text"><span class="title">Aether</span><span class="subtitle" id="version-display">Cargando...</span></div>
            </div>
            
            <nav class="nav-menu">
                <div class="nav-label">CONTROL</div>
                <button onclick="setTab('stats')" class="nav-item active" id="nav-stats"><i class="fa-solid fa-chart-pie"></i><span>Monitor</span></button>
                <button onclick="setTab('console')" class="nav-item" id="nav-console"><i class="fa-solid fa-terminal"></i><span>Consola</span></button>
                <div class="nav-label">SISTEMA</div>
                <button onclick="setTab('config')" class="nav-item" id="nav-config"><i class="fa-solid fa-sliders"></i><span>Ajustes</span></button>
            </nav>

            <div class="sidebar-footer">
                <button class="btn btn-secondary" onclick="document.getElementById('appearance-modal').classList.add('active')" style="width:100%; margin-bottom:15px;">
                    <i class="fa-solid fa-palette"></i> Personalizar
                </button>
                <div class="user-card">
                    <div id="status-dot" class="status-dot offline"></div>
                    <div class="user-info"><div id="status-text" class="status-text-main">OFFLINE</div></div>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <header class="top-bar">
                <h1 style="font-weight:800; font-size:1.8rem;">Panel de Control</h1>
                <div class="header-actions">
                    <button onclick="apiPower('start')" class="action-btn start"><i class="fa-solid fa-play"></i></button>
                    <button onclick="apiPower('restart')" class="action-btn restart"><i class="fa-solid fa-rotate"></i></button>
                    <button onclick="apiPower('stop')" class="action-btn stop"><i class="fa-solid fa-stop"></i></button>
                    <button onclick="apiPower('kill')" class="action-btn" style="background:#374151"><i class="fa-solid fa-skull"></i></button>
                </div>
            </header>

            <!-- TAB: MONITOR -->
            <div id="tab-stats" class="tab-view active">
                <div class="stats-grid">
                    <div class="card glass-panel">
                        <div class="card-title">CPU</div>
                        <div><span class="big-number" id="cpu-val">0%</span></div>
                        <div class="chart-container"><canvas id="cpu-chart"></canvas></div>
                    </div>
                    <div class="card glass-panel">
                        <div class="card-title">RAM</div>
                        <div><span class="big-number" id="ram-val">0 GB</span></div>
                        <div class="chart-container"><canvas id="ram-chart"></canvas></div>
                    </div>
                    <div class="card glass-panel">
                        <div class="card-title">DISCO</div>
                        <div><span class="big-number" id="disk-val">0 MB</span></div>
                        <div class="progress-bar-bg"><div id="disk-bar" class="progress-bar-fill warning" style="width:0%"></div></div>
                    </div>
                </div>
            </div>

            <!-- TAB: CONSOLA -->
            <div id="tab-console" class="tab-view">
                <div class="console-full glass-panel">
                    <div class="console-header"><span>root@server:~</span></div>
                    <div id="terminal" class="console-output" style="height:100%; width:100%"></div>
                </div>
            </div>

            <!-- TAB: AJUSTES (Con Whitelist) -->
            <div id="tab-config" class="tab-view">
                <div class="glass-panel" style="padding: 24px;">
                    <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3>Configuración del Servidor</h3>
                        <button class="btn btn-primary" onclick="saveCfg()"><i class="fa-solid fa-save"></i> Guardar Todo</button>
                    </div>
                    <div id="cfg-list" class="settings-layout">
                        <p style="text-align:center; padding:20px; color:gray">Cargando configuración...</p>
                    </div>
                </div>
            </div>

        </main>
    </div>
    <script src="app.js"></script>
</body>
</html>
